---
title: "Analysis of Google Play Store Apps"
author: "Minhaz Khan"
date: "January 12, 2019"
output: html_document
---

```{r}
library(tidyverse)
```


##Reading in the Data
```{r}
apps = read_csv("googleplaystore.csv")
head(apps)
```

##Average rating of each genre

Filtered out the missing rating values and stored them in a new data frame which we will use for the rest of the analysis.

```{r}
apps %>% filter(Rating != 'NaN') -> true_apps
true_apps %>% group_by(Genres) %>% summarise(avg=mean(Rating))
```
Getting a glimpse of the data to convert the numerical data from being characters
```{r}
glimpse(true_apps)
```

##Seperating Numerical and Character values from columns
```{r}
true_apps %>% filter(Size != "Varies with device") %>% 
  separate(Size, c("Size","Type"), sep = -1, convert = TRUE) %>% 
  separate(Installs, c("Installs","Symbol"), sep = -1, convert = TRUE) %>% drop_na() -> apps2

apps2$Price = parse_number(apps2$Price)

apps2$Symbol = NULL
apps2$Category = NULL
apps2$`Current Ver`= NULL
```
Removed Symbol because it was just character; removed category because it was the same as genre, removed Current Version because it isn't as necessary as when the app was last updated. Kept Android version because exploring app compatibility with OS might be interesting.

##Converting character values to numeric
```{r}
apps2$Installs = as.numeric(gsub(",","",apps2$Installs))
apps2$Size = as.numeric(as.character(apps2$Size))
glimpse(apps2)
```
Converting dates
```{r}
library(lubridate)
apps2$`Last Updated` = gsub(",","",apps2$`Last Updated`)
apps2 %>% mutate(`Last Update` = mdy(`Last Updated`)) -> apps2

```
Attempting to factor prices as paid or not:
```{r}
apps2 %>% mutate(Price = case_when(
                              Price == 0 ~ Price, 
                              Price > 0 ~ Price/Price,
                              TRUE ~ NA_real_)) -> apps2
#apps2 %>% factor(Price, levels = 1:2, labels = "Paid") %>% select(Price)

```

Converting kilobyte app size
```{r}
apps2 %>% mutate(SIZE = case_when(
                              Type == "M" ~ Size, 
                              Type == "k" ~ Size/1024,
                              TRUE ~ NA_real_)) -> apps2

apps2 %>% separate_rows(Genres, sep = ";", convert = FALSE) -> apps2

apps2$Size = NULL
apps2$Type = NULL
```



##Some Descriptive Statistics
```{r}
apps2 %>% group_by(Genres) %>% summarise(m=mean(Rating))
(apps_aov = aov(Rating~SIZE+Installs+Price+Reviews+Genres+`Content Rating`+`Last Update`, data = apps2))

summary(apps_aov)

```

##Graphing the relationship between the rating and other numerical factors
```{r}
ggplot(apps2, aes(Rating,log(Installs)))+geom_point()+xlim(0,5)+ylim(min(log(apps2$Installs)),max(log(apps2$Installs)))+geom_smooth()
ggplot(apps2, aes(Rating,log(Reviews)))+geom_point()+xlim(0,5)+ylim(min(log(apps2$Reviews)),max(log(apps2$Reviews)))+geom_smooth()
ggplot(apps2, aes(Rating,SIZE))+geom_point()+xlim(0,5)+ylim(min(apps2$SIZE),max(apps2$SIZE))+geom_smooth()
ggplot(apps2, aes(Rating,Price))+geom_point()+xlim(0,5)+ylim(min(apps2$Price),max(apps2$Price))+geom_smooth()
#appplot + ylim(0,5) + xlim(1,1.0e+09)
#appplot + ylim(0,5)
```
Effective rating goes down after reaching its peak in proportion to the categories above as expected. This highlights the fact that good apps exist but doesn't get much attention or the ratings and reviews are fabricated.

## Regression Models

```{r}
appreg = lm(Rating~SIZE+I(log(Installs))+I(log(Reviews))+`Last Update`+Genres+Price, data = apps2, weights = Installs)
summary(appreg)
```
Taking the log of Installs and Reviews and weighing it with the Installs helped increase the R squared to about 42%
```{r}
ggplot(appreg, aes(x=.fitted, y=.resid))+geom_point()+geom_smooth()
```

##Kmeans for Genres
```{r}
library(klaR)
```
```{r}
genres = kmodes(apps2[,c(1,3:5)], modes = 5, iter.max = 10, weighted = FALSE)

plot(jitter(apps2$Rating),col = genres$cluster)
points(genres$modes, col = 1:5, pch = 8)
```

